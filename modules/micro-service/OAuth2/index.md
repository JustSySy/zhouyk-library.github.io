# 微服务安全架构-OAuth2 

## 问题

- 开放系统授权第三方应用授权
- 微服务应用之间、多客户端的鉴权认证
- 第三方应用的联合登录(微博->淘宝)

## OAuth2 是什么
授权框架，仅用于授权代理，具体的安全场景需要定制

- 一般用于restful-api 的代理授权
- 基于令牌Token,无密授权
- 认证、授权分离（与shiro一样）
- 支持多种客户端的标准安全框架
  - Server--Server
  - Server--SPA
  - Server--App
  - Server--Web

## 架构角色
- 资源拥有者：一般为用户
- 用户代理：一般为多客户端（APP）
- 资源服务器：受保护的资源所在的服务器
- 授权服务器：提供认证、授权和颁发令牌
- 客户凭证：clientId和密码
- 令牌：【授权服务器】 颁发的Tokens
- 作用域：为【资源拥有者】 权限的细分

## 令牌类型
- 授权码：用于授权，交换获取 【访问令牌】 、 【刷新令牌】
- 刷新令牌：用于获取一个新的 【访问令牌】
- 访问令牌：用于代表用户或服务访问 【资源服务器】
- Bearer Token：Token拿到就可以用
- PoP Token：校验Token是否属于对应的clientId（相对于 【Bearer Token】）


## 授权模式
OAuth2可以实现四种典型的授权服务器流程，以应对不同的需求

- 授权码模式授权服务器
- 简化模式授权服务器
- 密码模式授权服务器
- 客户端模式授权服务器

#### 授权码模式
> 用户
